clc
clear
mu1=5;
sigma1=2.2;
alpha1=0.22;
mu2=10;
sigma2=1.2;
alpha2=0.38;
mu3=15;
sigma3=3.8;
alpha3=0.4;
mean1=mu1*alpha1+mu2*alpha2+mu3*alpha3;
mean=[mean1,mean1,mean1];
a0=3*mean1^2-9-6*mean1^2;
a1=2*mean1;
a2=2*mean1;
a3=2*mean1;
syms t
y1=a0*t+log(alpha1*exp(mu1*a1*t+0.5*a1^2*sigma1^2*t^2)+alpha2*exp(mu2*a1*t+0.5*a1^2*sigma2^2*t^2)+alpha3*exp(mu3*a1*t+0.5*a1^2*sigma3^2*t^2));
y2=log(alpha1*exp(mu1*a2*t+0.5*a2^2*sigma1^2*t^2)+alpha2*exp(mu2*a2*t+0.5*a2^2*sigma2^2*t^2)+alpha3*exp(mu3*a2*t+0.5*a2^2*sigma3^2*t^2));
y3=log(alpha1*exp(mu1*a3*t+0.5*a3^2*sigma1^2*t^2)+alpha2*exp(mu2*a3*t+0.5*a3^2*sigma2^2*t^2)+alpha3*exp(mu3*a3*t+0.5*a3^2*sigma3^2*t^2));
parameter=800;
y=y1+y2+y3;
y_new=diff(y)-parameter;
t0=solve(y_new,t);
z1=subs(y,t,t0);
z=diff(y,2);
z2=subs(z,t,t0);
w=sign(t0)*(2*(t0*parameter-z1))^0.5;
v=t0*(z2)^0.5;
w_new=double(w);
v_new=double(v);
p_y=normcdf(w_new)+normpdf(w_new)*(1/w_new-1/v_new)